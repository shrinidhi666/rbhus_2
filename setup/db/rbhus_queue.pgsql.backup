--
-- PostgreSQL database dump
--

-- Dumped from database version 9.5.3
-- Dumped by pg_dump version 9.5.3

-- Started on 2016-07-23 10:34:04

SET statement_timeout = 0;
SET lock_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SET check_function_bodies = false;
SET client_min_messages = warning;
SET row_security = off;

DROP DATABASE rbhus_queue;
--
-- TOC entry 2109 (class 1262 OID 16393)
-- Name: rbhus_queue; Type: DATABASE; Schema: -; Owner: postgres
--

CREATE DATABASE rbhus_queue WITH TEMPLATE = template0 ENCODING = 'UTF8' LC_COLLATE = 'English_United States.1252' LC_CTYPE = 'English_United States.1252';


ALTER DATABASE rbhus_queue OWNER TO postgres;

\connect rbhus_queue

SET statement_timeout = 0;
SET lock_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SET check_function_bodies = false;
SET client_min_messages = warning;
SET row_security = off;

--
-- TOC entry 6 (class 2615 OID 2200)
-- Name: public; Type: SCHEMA; Schema: -; Owner: postgres
--

CREATE SCHEMA public;


ALTER SCHEMA public OWNER TO postgres;

--
-- TOC entry 2110 (class 0 OID 0)
-- Dependencies: 6
-- Name: SCHEMA public; Type: COMMENT; Schema: -; Owner: postgres
--

COMMENT ON SCHEMA public IS 'standard public schema';


--
-- TOC entry 1 (class 3079 OID 12355)
-- Name: plpgsql; Type: EXTENSION; Schema: -; Owner: 
--

CREATE EXTENSION IF NOT EXISTS plpgsql WITH SCHEMA pg_catalog;


--
-- TOC entry 2112 (class 0 OID 0)
-- Dependencies: 1
-- Name: EXTENSION plpgsql; Type: COMMENT; Schema: -; Owner: 
--

COMMENT ON EXTENSION plpgsql IS 'PL/pgSQL procedural language';


SET search_path = public, pg_catalog;

--
-- TOC entry 183 (class 1255 OID 16447)
-- Name: function_modified(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION function_modified() RETURNS trigger
    LANGUAGE plpgsql
    AS $$BEGIN
   NEW.modified = now(); 
   RETURN NEW;
END;$$;


ALTER FUNCTION public.function_modified() OWNER TO postgres;

SET default_tablespace = '';

SET default_with_oids = false;

--
-- TOC entry 182 (class 1259 OID 16415)
-- Name: host_details; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE host_details (
    host_ip character varying(128) NOT NULL,
    cpu_total integer,
    mem_total bigint,
    cpu_used integer,
    mem_used bigint,
    is_alive boolean,
    loadavg character varying(32),
    is_enabled boolean,
    modified timestamp without time zone DEFAULT now() NOT NULL,
    created timestamp without time zone DEFAULT now() NOT NULL,
    host_name character varying(128) NOT NULL
);


ALTER TABLE host_details OWNER TO postgres;

--
-- TOC entry 2113 (class 0 OID 0)
-- Dependencies: 182
-- Name: COLUMN host_details.loadavg; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON COLUMN host_details.loadavg IS '{now,5mins,15mins}';


--
-- TOC entry 2114 (class 0 OID 0)
-- Dependencies: 182
-- Name: COLUMN host_details.is_enabled; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON COLUMN host_details.is_enabled IS 'true: enabled, false: disabled';


--
-- TOC entry 181 (class 1259 OID 16403)
-- Name: host_types; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE host_types (
    host_type character varying(16) NOT NULL
);


ALTER TABLE host_types OWNER TO postgres;

--
-- TOC entry 2115 (class 0 OID 0)
-- Dependencies: 181
-- Name: COLUMN host_types.host_type; Type: COMMENT; Schema: public; Owner: postgres
--

COMMENT ON COLUMN host_types.host_type IS 'render,desktop,server';


--
-- TOC entry 1989 (class 2606 OID 16539)
-- Name: host_details_primary; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY host_details
    ADD CONSTRAINT host_details_primary PRIMARY KEY (host_ip, host_name);


--
-- TOC entry 1987 (class 2606 OID 16407)
-- Name: primary_host_type; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY host_types
    ADD CONSTRAINT primary_host_type PRIMARY KEY (host_type);


--
-- TOC entry 1990 (class 2620 OID 16532)
-- Name: trigger_host_details_modified; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER trigger_host_details_modified AFTER UPDATE ON host_details FOR EACH ROW EXECUTE PROCEDURE function_modified();


--
-- TOC entry 2111 (class 0 OID 0)
-- Dependencies: 6
-- Name: public; Type: ACL; Schema: -; Owner: postgres
--

REVOKE ALL ON SCHEMA public FROM PUBLIC;
REVOKE ALL ON SCHEMA public FROM postgres;
GRANT ALL ON SCHEMA public TO postgres;
GRANT ALL ON SCHEMA public TO PUBLIC;


-- Completed on 2016-07-23 10:34:05

--
-- PostgreSQL database dump complete
--

